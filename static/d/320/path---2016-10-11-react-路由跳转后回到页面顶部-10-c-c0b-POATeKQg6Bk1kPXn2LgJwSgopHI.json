{"data":{"markdownRemark":{"id":"23928e73-7e20-5e0c-a3ff-18a233730775","frontmatter":{"title":"React 路由跳转后回到页面顶部","date":"2016/10/11","tags":["React","前端","JavaScript"],"commentId":null},"excerpt":"在 React 组件间进行页面跳转后，发现页面的位置并不在页面顶部，而是在页面跳转前的位置。就是说浏览器的滚动条并没有回到顶部的位置。 经过搜索之后找到了解决方案： Scroll to the top of the page after render in react.js 可…","html":"<p>在 React 组件间进行页面跳转后，发现页面的位置并不在页面顶部，而是在页面跳转前的位置。就是说浏览器的滚动条并没有回到顶部的位置。</p>\n<p>经过搜索之后找到了解决方案：<a href=\"http://stackoverflow.com/questions/33188994/scroll-to-the-top-of-the-page-after-render-in-react-js\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Scroll to the top of the page after render in react.js</a></p>\n<p>可以使用下面这种解决，但是这种方式不是一种很好的解决方法。而且 <code class=\"language-text\">scrollIntoView()</code> 方法并不回到页面的顶部，应该使用 <code class=\"language-text\">scrollTop = 0</code> 的方式。</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token function-variable function\">componentDidUpdate</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span> ReactDom<span class=\"token punctuation\">.</span><span class=\"token function\">findDOMNode</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">scrollIntoView</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token punctuation\">}</span></code></pre></div>\n<p>所以得到的解决方案是：</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token function\">componentDidUpdate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  ReactDOM<span class=\"token punctuation\">.</span><span class=\"token function\">findDOMNode</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>scrollTop <span class=\"token operator\">=</span> <span class=\"token number\">0</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<!--more-->\n<p>但是我使用这个之后，ESlint 报了个错：<code class=\"language-text\">no-find-dom-node</code>。\n查看 <code class=\"language-text\">eslint-plugin-react</code> 的<a href=\"https://github.com/yannickcr/eslint-plugin-react/blob/master/docs/rules/no-find-dom-node.md\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">文档</a>可以看到 Facebook 不推荐使用 <code class=\"language-text\">findDOMNode</code>，推荐使用 <code class=\"language-text\">refs</code> 获取 DOM 节点。</p>\n<p>所以推荐的使用方法是：</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">MyComponent</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">componentDidMount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">.</span><span class=\"token function\">scrollIntoView</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token operator\">&lt;</span>div ref<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token parameter\">node</span> <span class=\"token operator\">=></span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>node <span class=\"token operator\">=</span> node<span class=\"token punctuation\">}</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>","timeToRead":1}},"pageContext":{"isCreatedByStatefulCreatePages":false,"id":"23928e73-7e20-5e0c-a3ff-18a233730775"}}